/*! For license information please see 19.b4aaff75611715868744.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{1172:function(e,t,n){"use strict";n.d(t,"a",(function(){return W}));var i,o=n(249),r=n.n(o),a=n(41),s=n.n(a),l=n(46),c=n.n(l),d=n(291),u=n.n(d),h=n(277),f=n.n(h),p=n(78),_=n.n(p),v=n(79),m=n.n(v),g=n(53),b=n.n(g),y=n(49),w=n.n(y),C=n(1),k=n.n(C),S=n(0),M=n.n(S),E=n(292),T=n(2),D=n(613),I=n(63);function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=b()(e);if(t){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return m()(this,n)}}var x="code-commented-highlight",H="comment",L="plus",F=(i={},w()(i,H,"code-comments-gutter-icon-comment"),w()(i,L,"code-comments-gutter-icon-plus"),i),P=function(e){_()(n,e);var t=N(n);function n(e){var i;return s()(this,n),(i=t.call(this,e))._c_activated=!1,i._c_gutterHoveredInfo=null,i._c_debounceFileChange=M.a.debounce(i._c_onFileChange.bind(u()(i)),1e3,{maxWait:5e3}),i._c_debounceUpdateWidgetPositions=M.a.debounce(i._c_updateWidgetPositions.bind(u()(i)),200,{maxWait:1e3}),i}return c()(n,[{key:"_c_setLinesHighlight",value:function(e,t){return this.editor().deltaDecorations([],[{range:I.a.Range.fromPositions({lineNumber:e,column:1},{lineNumber:t,column:1}),options:{isWholeLine:!0,className:x}}])}},{key:"_c_addGutterMarker",value:function(e,t,n){var i={lineNumber:t,column:1};return this.editor().deltaDecorations([],[{range:I.a.Range.fromPositions(i,i),options:{isWholeLine:!0,glyphMarginClassName:"ss-icon ".concat(F[e]," ").concat(n?"collapsed":"")}}])}},{key:"_c_toggleThread",value:function(e){var t=this,n=e.overlayWidget,i=e.thread,o=e.el,r=e.highlightId,a=e.viewZoneId,s=e.gutterMarkerId,l=e.lineHandle,c=i.lineNumber+i.lineCount;if(this.editor().deltaDecorations(s,[]),e.gutterMarkerId=this._c_addGutterMarker(H,c,n),n)this.editor().removeOverlayWidget(n),o&&o.remove(),r&&this.editor().deltaDecorations(r,[]),a&&this.editor().changeViewZones((function(e){e.removeZone(a)})),e.overlayWidget=null,e.viewZoneId=null,e.el=null,e.highlightId=null;else{var d=D.a(i),u=this._c_renderWidget(i.id,l,i.lineCount,d.get(0));e.highlightId=this._c_setLinesHighlight(i.lineNumber+1,c),e.el=d,u.then((function(t){var n=t.viewZoneId,i=t.overlayWidget;e.overlayWidget=i,e.viewZoneId=n}))}M.a.defer((function(){return t._c_updateWidgetPositions()})),D.b(i,!!n)}},{key:"_c_getContext",value:function(e,t){return{code:this.editor().getValueInRange(I.a.Range.fromPositions({lineNumber:e,column:1},{lineNumber:e+t-1,column:Number.MAX_SAFE_INTEGER})),codeContextBefore:this.editor().getValueInRange(I.a.Range.fromPositions({lineNumber:e-5,column:1},{lineNumber:e-1,column:Number.MAX_SAFE_INTEGER})),codeContextAfter:this.editor().getValueInRange(I.a.Range.fromPositions({lineNumber:e+t,column:1},{lineNumber:e+t+5-1,column:Number.MAX_SAFE_INTEGER}))}}},{key:"_c_addThread",value:function(e){this._c_clearCurrentHovered();var t=e,n=1,i=this.editor().getSelections();if(i.length){var o=i&&M.a.find(i,(function(t){return t.startLineNumber<=e&&t.endLineNumber>=e}));o&&(t=o.startLineNumber,n=o.endLineNumber-t+1)}var r=this._c_getContext(t,n),a=D.e(this.fileName,t-1,n,r.code,r.codeContextBefore,r.codeContextAfter);this._c_gutterHoveredInfo=null,this._c_refreshThread(a.id)}},{key:"_c_updateWidgetPositions",value:function(){var e=this;this._c_lineWidgets.forEach((function(t){var n=t.overlayWidget;n&&e.editor().layoutOverlayWidget(n)}))}},{key:"_c_onMouseMove",value:function(e){var t=e.target,n=t.position,i=2===t.type;if(!i&&this._c_clearCurrentHovered(),i&&(!this._c_gutterHoveredInfo||n.lineNumber!==this._c_gutterHoveredInfo.lineNumber)){var o=M.a.find(this._c_lineWidgets,(function(e){var t=e.thread;return n.lineNumber===t.lineNumber+t.lineCount}));this._c_clearCurrentHovered(),o||(this._c_gutterHoveredInfo={lineNumber:n.lineNumber,id:this._c_addGutterMarker(L,n.lineNumber)})}}},{key:"_c_onMouseLeave",value:function(){this._c_clearCurrentHovered()}},{key:"_c_onMouseDown",value:function(e){var t=e.target,n=t.position;if(2===t.type){var i=M.a.find(this._c_lineWidgets,(function(e){var t=e.thread;return t.lineNumber+t.lineCount===n.lineNumber}));i?i.thread.temporary?D.g(i.thread,i.thread.comments[0].id):this._c_toggleThread(i):this._c_addThread(n.lineNumber)}}},{key:"_c_clearCurrentHovered",value:function(){null!==this._c_gutterHoveredInfo&&(this.editor().deltaDecorations(this._c_gutterHoveredInfo.id,[]),this._c_gutterHoveredInfo=null)}},{key:"activate",value:function(e){var t=this;return this._c_editorClosed?k.a.Deferred().reject():f()(b()(n.prototype),"activate",this).apply(this,arguments).then((function(){if(t.fileName&&!t._c_activated){t._c_eventHandles=[],t._c_lineWidgets=[],t._c_gutterHoveredInfo=null,e.setOption("glyphMargin",!0);var n=M.a.bind(t._c_eventHandles.push,t._c_eventHandles);if(n(T.a.subscribe("project:commentsUpdated",(function(e,n){var i=n.updateId;M.a.defer((function(){return t._c_calculateChangedThreads(i)}))}))),n(T.a.subscribe("codeComments:comment:removed:#path:#threadId",(function(e){var n=e.path,i=e.threadId;return t.fileName===n&&t._c_refreshThread(i)}))),n(T.a.subscribe("codeComments:thread:removed:#path:#id",(function(e){var n=e.path,i=e.id;return t.fileName===n&&t._c_destroyThread(i)}))),n(T.a.subscribe("codeComments:comment:cancelled:#path:#threadId",(function(e){var n=e.path,i=e.threadId;return t.fileName===n&&t._c_refreshThread(i)}))),n(T.a.subscribe("codeComments:comment:saved:#path:#threadId",(function(e,n){var i=e.path,o=e.threadId;t.fileName===i&&(n&&t._c_destroyThread(n),t._c_refreshThread(o))}))),n(T.a.subscribe("codeComments:comment:edit:#path:#threadId",(function(e){var n=e.path,i=e.threadId;return t.fileName===n&&t._c_refreshThread(i)}))),n(T.a.subscribe("codeComments:comment:add:#path:#threadId",(function(e){var n=e.path,i=e.threadId;return t.fileName===n&&t._c_refreshThread(i)}))),n(T.a.subscribe("panel:size:change",t._c_updateSize.bind(t))),!t._c_onLocalFileChange){var i=t.fileName;t._c_onLocalFileChange=function(){i===t.fileName?t._c_debounceFileChange&&t._c_debounceFileChange():i=t.fileName}}t._c_onContentChangeDisposableHandler=t.editor().onDidChangeModelContent(t._c_onLocalFileChange.bind(t)),t._c_onContentChangeDisposableHandler=t.editor().onDidChangeModelContent((function(){t._c_onLocalFileChange(),t._c_debounceUpdateWidgetPositions()})),t._c_activateComments()}}))}},{key:"_c_loadComments",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return D.d(this.fileName,e).then((function(e){return e.commentThreadsMap}))}},{key:"_c_activateComments",value:function(){var e=this;this._c_activated=!0,this._c_loadComments().then((function(t){e._c_onMouseMoveDisposableHandler||e.editor()&&(e._c_onMouseMoveDisposableHandler=e.editor().onMouseMove(e._c_onMouseMove.bind(e)),e._c_onMouseLeaveDisposableHandler=e.editor().onMouseLeave(e._c_onMouseLeave.bind(e)),e._c_onMouseDownDisposableHandler=e.editor().onMouseDown(e._c_onMouseDown.bind(e)),M.a.defer((function(){e.editor()&&M.a.each(t,(function(t){return e._c_renderThread(t)}))})))}))}},{key:"_c_onFileChange",value:function(){var e=this,t=[],n=[];this._c_lineWidgets.forEach((function(i){var o=i.thread,r=i.lineHandle.getLineNumber(),a=e._c_getContext(r,o.lineCount);null===r||a.code!==o.context.code?t.push(o.id):a.codeContextBefore===o.context.codeContextBefore&&a.codeContextAfter===o.context.codeContextAfter&&r===o.lineNumber+1||n.push({lineNumber:r-1,context:a,thread:o})})),D.i(this.fileName,t,n)}},{key:"_c_updateSize",value:function(){var e=this;this.editor().changeViewZones((function(t){M.a.each(e._c_lineWidgets,(function(e){var n=e.viewZoneId;return n&&t.layoutZone(n)}))}))}},{key:"_c_refreshThread",value:function(e){var t=this;if(this.editor()){var n=this.editor().getScrollLeft(),i=this.editor().getScrollTop();return this._c_loadComments().then((function(n){var i=M.a.find(n,(function(t){return t.id===e}));return t._c_destroyThread(e),t._c_renderThread(i)})).then((function(){t.editor().setScrollPosition(i,n),M.a.defer((function(){return t._c_updateWidgetPositions()}))}))}}},{key:"_c_collectEditState",value:function(){return M.a.map(k()(".comment.editMode"),(function(e){var t=k()(e);return{id:t.data("id"),comment:t.find(".message-ta").val(),newItem:!!t.data("new"),threadId:t.closest(".comments-list").data("thread-id")}}))}},{key:"_c_refreshThreads",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this.editor()){var n=this._c_collectEditState(),i=M.a.keyBy(n,"id"),o=M.a.filter(n,(function(e){return e.newItem})),r=this.editor().getScrollLeft(),a=this.editor().getScrollTop();this._c_loadComments(t).then((function(s){e._c_clearAllThreads(t),M.a.each(s,(function(r){if(t){n.length&&(r.comments=M.a.map(r.comments,(function(e){var t=i[e.id];return t&&(e.editMode=!0,e.comment=t.comment),e})));var a=M.a.filter(o,(function(e){return e.threadId===r.id}));a.length&&M.a.each(a,(function(e){var t=D.h();t.comment=e.comment,t.id=e.id,r.comments.push(t)}))}e._c_renderThread(r)})),e.editor().setScrollPosition(a,r),M.a.defer((function(){return e._c_updateWidgetPositions()}))}))}}},{key:"_c_renderWidget",value:function(e,t,n,i){var o=k.a.Deferred();i.style.left=this.editor().getLayoutInfo().contentLeft+"px";var r={getId:function(){return e},getDomNode:function(){return i},getPosition:function(){return null}};return this.editor().addOverlayWidget(r),this.editor().changeViewZones((function(e){var a=document.createElement("div");a.classList.add(x);var s=e.addZone({afterLineNumber:t.getLineNumber()+n-1,get heightInPx(){var e=getComputedStyle(i),t=parseInt(e.marginTop),n=parseInt(e.marginBottom);return i.offsetHeight+t+n},domNode:a,onDomNodeTop:function(e){i.style.top=e+"px"}});o.resolve({viewZoneId:s,overlayWidget:r})})),o.promise()}},{key:"_c_renderThread",value:function(e){var t=this,n=e.collapsed,i=e.lineNumber+e.lineCount,o=null,r=null,a=this.editor().getLineHandle(e.lineNumber+1),s=k.a.Deferred().resolve({});n||(o=D.a(e),s=this._c_renderWidget(e.id,a,e.lineCount,o.get(0)),r=this._c_setLinesHighlight(e.lineNumber+1,i));var l=this._c_addGutterMarker(H,i,n);return s.then((function(n){var i=n.viewZoneId,s=n.overlayWidget;t._c_lineWidgets.push({thread:e,highlightId:r,viewZoneId:i,gutterMarkerId:l,overlayWidget:s,el:o,lineHandle:a})}))}},{key:"_c_clearAllThreads",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._c_lineWidgets=M.a.filter(this._c_lineWidgets,(function(n){var i=n.highlightId,o=n.viewZoneId,a=n.gutterMarkerId,s=n.overlayWidget,l=n.el;return!(!t||!k()(l).data("temporary"))||(s&&e.editor().removeOverlayWidget(s),l&&l.remove(),i=i||[],e.editor().deltaDecorations([].concat(r()(i),r()(a)),[]),o&&e.editor().changeViewZones((function(e){e.removeZone(o)})),!1)}))}},{key:"_c_destroyThread",value:function(e){var t=M.a.findIndex(this._c_lineWidgets,(function(t){return t.thread.id===e})),n=this._c_lineWidgets[t];if(!n)return null;var i=n.highlightId,o=n.viewZoneId,a=n.gutterMarkerId,s=n.overlayWidget,l=n.el;s&&this.editor().removeOverlayWidget(s),l&&l.remove();var c=i||[];return this.editor().deltaDecorations([].concat(r()(c),r()(a)),[]),o&&this.editor().changeViewZones((function(e){e.removeZone(o)})),this._c_lineWidgets.splice(t,1),n}},{key:"_c_calculateChangedThreads",value:function(e){this._c_refreshThreads(e)}},{key:"_c_clean",value:function(){this.editor()&&this.editor().setOption("glyphMargin",!1),this._c_debounceFileChange&&this._c_debounceFileChange.flush(),this._c_activated=!1,this._c_gutterHoveredInfo=null,this._c_onMouseMoveDisposableHandler&&this._c_onMouseMoveDisposableHandler.dispose(),this._c_onMouseMoveDisposableHandler=null,this._c_onMouseLeaveDisposableHandler&&this._c_onMouseLeaveDisposableHandler.dispose(),this._c_onMouseLeaveDisposableHandler=null,this._c_onMouseDownDisposableHandler&&this._c_onMouseDownDisposableHandler.dispose(),this._c_onMouseDownDisposableHandler=null,this._c_onContentChangeDisposableHandler&&this._c_onContentChangeDisposableHandler.dispose(),this._c_onContentChangeDisposableHandler=null,this._c_onLocalFileChange=null,this._c_eventHandles&&(this._c_eventHandles.forEach((function(e){return T.a.unsubscribe(e)})),this._c_eventHandles.length=0),this.editor()&&(this._c_clearAllThreads(),D.c(this.fileName))}},{key:"deactivate",value:function(){return this._c_clean(),f()(b()(n.prototype),"deactivate",this).apply(this,arguments)}},{key:"close",value:function(){return this._c_clean(),this._c_debounceFileChange=null,this._c_debounceUpdateWidgetPositions=null,this._c_editorClosed=!0,f()(b()(n.prototype),"close",this).apply(this,arguments)}}]),n}(E.a),W=function(){return P}},1174:function(e){e.exports=JSON.parse('{"contentChanged":"markdown:contentChanged:#filename","previewUpdated":"markdown:previewUpdated"}')},1178:function(e,t,n){var i;i=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t){e.exports=function(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var n=e.hasAttribute("readonly");n||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),n||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var i=window.getSelection(),o=document.createRange();o.selectNodeContents(e),i.removeAllRanges(),i.addRange(o),t=i.toString()}return t}},function(e,t){function n(){}n.prototype={on:function(e,t,n){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var i=this;function o(){i.off(e,o),t.apply(n,arguments)}return o._=t,this.on(e,o,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),i=0,o=n.length;i<o;i++)n[i].fn.apply(n[i].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),i=n[e],o=[];if(i&&t)for(var r=0,a=i.length;r<a;r++)i[r].fn!==t&&i[r].fn._!==t&&o.push(i[r]);return o.length?n[e]=o:delete n[e],this}},e.exports=n,e.exports.TinyEmitter=n},function(e,t,n){var i=n(3),o=n(4);e.exports=function(e,t,n){if(!e&&!t&&!n)throw new Error("Missing required arguments");if(!i.string(t))throw new TypeError("Second argument must be a String");if(!i.fn(n))throw new TypeError("Third argument must be a Function");if(i.node(e))return function(e,t,n){return e.addEventListener(t,n),{destroy:function(){e.removeEventListener(t,n)}}}(e,t,n);if(i.nodeList(e))return function(e,t,n){return Array.prototype.forEach.call(e,(function(e){e.addEventListener(t,n)})),{destroy:function(){Array.prototype.forEach.call(e,(function(e){e.removeEventListener(t,n)}))}}}(e,t,n);if(i.string(e))return function(e,t,n){return o(document.body,e,t,n)}(e,t,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var n=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"==typeof e||e instanceof String},t.fn=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},function(e,t,n){var i=n(5);function o(e,t,n,i,o){var a=r.apply(this,arguments);return e.addEventListener(n,a,o),{destroy:function(){e.removeEventListener(n,a,o)}}}function r(e,t,n,o){return function(n){n.delegateTarget=i(n.target,t),n.delegateTarget&&o.call(e,n)}}e.exports=function(e,t,n,i,r){return"function"==typeof e.addEventListener?o.apply(null,arguments):"function"==typeof n?o.bind(null,document).apply(null,arguments):("string"==typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,(function(e){return o(e,t,n,i,r)})))}},function(e,t){if("undefined"!=typeof Element&&!Element.prototype.matches){var n=Element.prototype;n.matches=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector}e.exports=function(e,t){for(;e&&9!==e.nodeType;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}}},function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resolveOptions(t),this.initSelection()}return a(e,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=e.action,this.container=e.container,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var e=this,t="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return e.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=o()(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=o()(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){this.emitter.emit(e?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),document.activeElement.blur(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(e){if(void 0!==e){if(!e||"object"!==(void 0===e?"undefined":r(e))||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(e.hasAttribute("readonly")||e.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=e}},get:function(){return this._target}}]),e}(),l=n(1),c=n.n(l),d=n(2),u=n.n(d),h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),p=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.resolveOptions(n),i.listenClick(e),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),f(t,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText,this.container="object"===h(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=u()(e,"click",(function(e){return t.onClick(e)}))}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new s({action:this.action(t),target:this.target(t),text:this.text(t),container:this.container,trigger:t,emitter:this})}},{key:"defaultAction",value:function(e){return _("action",e)}},{key:"defaultTarget",value:function(e){var t=_("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return _("text",e)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"==typeof e?[e]:e,n=!!document.queryCommandSupported;return t.forEach((function(e){n=n&&!!document.queryCommandSupported(e)})),n}}]),t}(c.a);function _(e,t){var n="data-clipboard-"+e;if(t.hasAttribute(n))return t.getAttribute(n)}t.default=p}]).default},e.exports=i()},1203:function(e,t,n){"use strict";n.r(t);var i=n(41),o=n.n(i),r=n(46),a=n.n(r),s=n(277),l=n.n(s),c=n(78),d=n.n(c),u=n(79),h=n.n(u),f=n(53),p=n.n(f),_=n(1),v=n.n(_),m=n(12),g=n.n(m),b=n(4),y=n(2),w=n(10),C=n(37),k=n(63),S=n(1172),M=n(1174);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return h()(this,n)}}var T=y.a.create(M),D=g.a.compile('<ul class="preview-overlay {{className}}">\n  <li><button aria-label="Switch to preview" title="Switch to preview" class="preview-switch-type" data-type="preview"><i class="ss-icon">textfile</i></button></li>\n  <li><button aria-label="Switch to split" title="Switch to split" class="preview-switch-type splitview" data-type="split"><i class="ss-icon">openbook</i></button></li>\n</ul>\n'),I=function(e){d()(n,e);var t=E(n);function n(e){var i;return o()(this,n),(i=t.call(this,e))._md_showIcons=!1!==e.showIcons,e.tab&&i.setTab(e.tab),i}return a()(n,[{key:"activate",value:function(e){var t=this;return l()(p()(n.prototype),"activate",this).call(this,e).then((function(){if(!t._md_spellChecker){var n=C.default.get("editor").spellcheck;t._md_spellChecker=new k.c(t.editor(),n),t._md_spellChecker.init()}t._md_settingsChangeHandler&&y.a.unsubscribe(t._md_settingsChangeHandler),t._md_settingsChangeHandler=y.a.subscribe("editor:settings:changed",t._md_onEditorSettingsChanged.bind(t)),t._md_template&&t._md_template.remove();var i=e.getOption("minimap")&&e.getOption("minimap").enabled;t._md_template=v()(D({className:i?"with-minimap":""})),t._md_showIcons&&(t.container().append(t._md_template),y.a.on(t._md_template,"click.editor",".preview-switch-type",t._md_switchToPreview.bind(t))),t.editor().connect(t.container()),b.a.ide.isFullScreen?t.enterFullscreen():t.leaveFullscreen(),t._md_bindModelEvents()}))}},{key:"_md_onEditorSettingsChanged",value:function(){var e=this.editor().getOption("minimap")&&this.editor().getOption("minimap").enabled;this._md_template.removeClass("with-minimap"),e&&this._md_template.addClass("with-minimap"),this._md_template=v()(D({className:e?"with-minimap":""}));var t=C.default.get("editor").spellcheck;this._md_spellChecker.enableSpellchecker(t)}},{key:"_md_cleanUp",value:function(){this._md_unbindModelEvents(),this._md_settingsChangeHandler&&y.a.unsubscribe(this._md_settingsChangeHandler),this._md_settingsChangeHandler=null,this._md_template&&(y.a.off(this._md_template,"click.editor"),this._md_template.remove(),this._md_template=null,this._md_spellChecker&&this._md_spellChecker.cleanup())}},{key:"_md_onContentChange",value:function(){T.contentChanged({filename:this.fileName},this.editor().getContent())}},{key:"_md_unbindModelEvents",value:function(){this._md_onDidModelContentChangeDisposable&&this._md_onDidModelContentChangeDisposable.dispose(),this._md_onDidModelContentChangeDisposable=null}},{key:"_md_bindModelEvents",value:function(){this.editor()&&(this._md_onDidModelContentChangeDisposable=this.editor().onDidChangeModelContent(this._md_onContentChange.bind(this)))}},{key:"deactivate",value:function(){this._md_cleanUp(),l()(p()(n.prototype),"deactivate",this).call(this,arguments)}},{key:"close",value:function(){this._md_cleanUp(),l()(p()(n.prototype),"close",this).call(this,arguments)}},{key:"setTab",value:function(e){this._tab=e}},{key:"fileDrop",value:function(){w.default.dropHelper((function(e){return"!["+w.default.path.getFileName(e.path)+"]("+e.path+")"})).apply(null,arguments)}},{key:"_md_switchToPreview",value:function(e){var t="split"===v()(e.target).closest(".preview-switch-type").data("type")?"splitview":"preview";this._tab&&this._tab.switchType(t)}},{key:"setModel",value:function(e){this.editor().setModel(e)}}]),n}(Object(S.a)()),N=n(0),x=n.n(N),H=n(1178),L=n.n(H),F=n(18),P=n(251),W=n(355),A=n(146),O=y.a.create(n(1174));function R(e,t){this.options=e,this.plugins=t||[],this.container=e.container,this.template=v()(g.a.compile('<ul class="preview-overlay">\n  <li><button aria-label="Reload preview" title="Reload preview" class="preview-refresh"><i class="ss-icon">sync</i></button></li>\n  <li><button aria-label="Open in new browser ta" title="Open in new browser tab" class="preview-expand"><i class="ss-icon">navigate</i></button></li>\n  <li><button aria-label="Switch to code" title="Switch to code" class="preview-switch-type" data-type="code"><i class="ss-icon">draw</i></button></li>\n  <li><button aria-label="Switch to split" title="Switch to split" class="preview-switch-type splitview" data-type="split"><i class="ss-icon">openbook</i></button></li>\n</ul>\n<section class="rendered-markdown"></section>\n')());var n=e.fileContent;n instanceof P.a?this._model=n.model:n instanceof k.d&&(this._model=n),this.renderFunction=e.renderFunction,function(e,t,n){if(e.renderFunction)return j(e);V(t,n).then(v.a.proxy(e,"render")).then((function(){e.value=t}))}(this,this.options.fileContent?this.options.fileContent.getValue():"",this.plugins);var i=this._onContentChanged.bind(this);this._onContentChange=x.a.debounce(i,200,{maxWait:600}),this.clipboard=new L.a(".btn-clipboard"),this.clipboard.on("success",(function(e){e.clearSelection()})),this._bindButtonEvents()}function j(e){return e.renderFunction(e.container).then((function(){O.previewUpdated()}))}var Z=R.prototype;function U(e){e._onContentChangeDisposable&&e._onContentChangeDisposable.dispose(),e._onContentChangeDisposable=null}function B(e){e._onContentChangeDisposable||(e._onContentChangeDisposable=e._model.onDidChangeModelContent(e._onContentChange))}function V(e,t){return w.default.markdown.render(e,{breaks:!0,sanitize:!0,allowedTags:"iframe|br",smartLists:!0,highlight:W.a},void 0,t).fail((function(e){console.error(e),F.a.error("Unable to parse and render markdown")}))}function z(e){var t="split"===v()(e.target).closest(".preview-switch-type").data("type")?"splitview":"code";this.tab&&this.tab.switchType(t)}Z.render=function(e){var t=this.template.filter(".rendered-markdown"),n=t[0].scrollTop||0;t.html(e),this.container.html(this.template),t[0].scrollTop=n,this._bindButtonEvents(),O.previewUpdated()},Z.activate=function(){this.firstRun?this.refresh():this.firstRun=!0},Z.refresh=function(){var e=this;if(x.a.isFunction(e.renderFunction)){var t=e.getScrollContainer(),n=t.scrollTop();return j(e).then((function(){t.scrollTop(n)}))}var i=this.options.fileContent.getValue();V(i,this.plugins).then((function(t){e.container.find(".rendered-markdown").html(t),e.value=i}))},Z.expand=function(){A.a.openPreview(!1,this.tab.filename)},Z.afterActivate=function(){x.a.isUndefined(this._prevPosition)||this.getScrollContainer().scrollTop(this._prevPosition),B(this)},Z.beforeDeactivate=function(){var e=this.getScrollContainer();x.a.isUndefined(e)||(this._prevPosition=this.getScrollContainer().scrollTop()),U(this)},Z.setModel=function(e){U(this),this._model=e,B(this),this.getScrollContainer().scrollTop(0),delete this._prevPosition,this._onContentChange()},Z._onContentChanged=function(){var e=this;if(x.a.isFunction(e.renderFunction)){var t=e.getScrollContainer();if(!t)return;var n=t.scrollTop();return j(e).then((function(){t.scrollTop(n)}))}var i=this._model.getValue();return V(i,this.plugins).then(this.render.bind(this)).then((function(){e.value=i}))},Z.getScrollContainer=function(){var e=this.container.find("iframe.guides-iframe");return e.length>0?e.data("instance"):this.container.find(".rendered-markdown")},Z._bindButtonEvents=function(){y.a.off(this.container,"click.preview");var e=y.a.on.bind(y.a,this.container);e("click.preview",".preview-refresh",this.refresh.bind(this)),e("click.preview",".preview-expand",this.expand.bind(this)),e("click.preview",".preview-switch-type",z.bind(this))},Z.close=function(){this.template.remove(),y.a.off(this.template,"click.preview"),U(this),x.a.each(this.layoutUpdateIds,y.a.unsubscribe),this.clipboard.off("success"),this.clipboard.destroy()},Z.setTab=function(e){this.tab=e};var G=R,q=n(49),X=n.n(q),J=g.a.compile('<div class="vertical-panel-container splitview">\n    <section id="md-editor"></section>\n    <section id="md-preview"></section>\n</div>'),Y=function(){function e(t){var n=this;o()(this,e),X()(this,"fileDrop",w.default.dropHelper((function(e){return"!["+w.default.path.getFileName(e.path)+"]("+e.path+")"}))),this._container=t.container,this._template=v()(J()),this._editorContainer=this._template.find("#md-editor"),this._previewContainer=this._template.find("#md-preview");var i=x.a.clone(t);i.container=this._editorContainer,i.showIcons=!1,this._editor=new I(i);var r=x.a.clone(t);r.container=this._previewContainer,this._preview=new G(r);var a=t.fileContent;a instanceof P.a?this._model=a.model:a instanceof k.d&&(this._model=a),this._fsHandlerId=y.a.subscribe("ide:fullscreen:#mode",this._onFullscreen.bind(this)),y.a.on(this._template,"resize",(function(){n._scrollMap=null,n._viewportHeight=null,n._lastScrollLine=null})),this._template.find(".preview-overlay .preview-refresh, .preview-switch-type.splitview").hide(),this._preventPreviewSDebounced=x.a.debounce(this._preventPreviewS.bind(this),500),this._preventEditorSDebounced=x.a.debounce(this._preventEditorS.bind(this),500),this._syncScrollEditorDebounce=x.a.debounce(this._syncScrollEditor.bind(this),50,{maxWait:50}),this._syncScrollPreviewDebounce=x.a.debounce(this._syncScrollPreview.bind(this),50,{maxWait:50})}return a()(e,[{key:"activate",value:function(){this._container.append(this._template),this._editor&&this._editor.activate.apply(this._editor,arguments),v()(this._editor.editor().connectContainer).find(".preview-switch-type.splitview").hide(),this._preview.refresh(),this._unbindEvents(),this._bindEvents()}},{key:"close",value:function(){this._template.off(),y.a.unsubscribe(this._fsHandlerId),this._unbindEvents(),this._editor&&this._editor.close.apply(this._editor,arguments),this._preview&&this._preview.close.apply(this._preview,arguments),this._editorContainer=null,this._previewContainer=null,this._template.remove()}},{key:"afterActivate",value:function(){this._preview&&this._preview.afterActivate.apply(this._preview,arguments),this._editor&&this._editor.afterActivate.apply(this._editor,arguments)}},{key:"deactivate",value:function(){this._unbindEvents(),this._editor&&this._editor.deactivate.apply(this._editor,arguments)}},{key:"beforeDeactivate",value:function(){this._preview&&this._preview.beforeDeactivate.apply(this._preview,arguments)}},{key:"setTab",value:function(e){this._editor&&this._editor.setTab(e),this._preview&&this._preview.setTab(e)}},{key:"_onModelContentChange",value:function(){this.scrollMap=null,this.prevRenderedContent=void 0}},{key:"_syncScrollEditor",value:function(){var e=this._editor.editor(),t=this._preview.getScrollContainer();if(e&&this._previewContainer&&t){y.a.off(t,"scroll",this._syncScrollPreviewDebounce);var n=e.getVisibleRanges()[0].startLineNumber;if((t.isIframe?t.content!==this._prevRenderedContent:this._preview.value!==this._prevRenderedContent)&&(this._scrollMap=null),this._scrollMap||(this._scrollMap=this._buildScrollMapFromEditor(e)),this._scrollMap){this._prevRenderedContent=t.isIframe?t.content:this._preview.value;var i=this._scrollMap[n];n!==this._lastEditorScrollLine?(this._lastEditorScrollLine=n,t.scrollTop(i)):this._preventPreviewSDebounced()}}}},{key:"_bindEvents",value:function(){var e=this;this._onModelContentChangeDisposable&&this._onModelContentChangeDisposable.dispose(),this._onModelContentChangeDisposable=this._editor.editor().onDidChangeModelContent(this._onModelContentChange.bind(this)),this._updateEvent=y.a.subscribe("markdown:previewUpdated",(function(){y.a.on(e._preview.getScrollContainer(),"scroll",e._syncScrollPreviewDebounce),e._syncScrollEditor()})),this._scrollChangeDisposable=this._editor.editor().onDidScrollChange((function(){e._syncScrollEditorDebounce()}))}},{key:"_unbindEvents",value:function(){this._onModelContentChangeDisposable&&this._onModelContentChangeDisposable.dispose(),this._onModelContentChangeDisposable=null,this._scrollChangeDisposable&&this._scrollChangeDisposable.dispose(),this._scrollChangeDisposable=null,y.a.unsubscribe(this._updateEvent)}},{key:"_onFullscreen",value:function(e,t){this._editor&&("enter"===e.mode?t.extension===this&&this._editor.enterFullscreen():this._editor.leaveFullscreen())}},{key:"_syncScrollPreview",value:function(){this._scrollChangeDisposable&&this._scrollChangeDisposable.dispose(),this._scrollChangeDisposable=null;var e=this._preview.getScrollContainer(),t=this._editor.editor(),n=0;if(e.children(".line").each((function(e,t){if(v()(t).offset().top>1)return n=parseFloat(v()(t).data("line")),!1})),this._scrollMap||(this._scrollMap=this._buildScrollMapFromEditor(t)),n!==this._lastScrollLine){var i=t.getTopForLineNumber(n);v()(t.getScrollerElement()).stop(!0).animate({scrollTop:i},100),this._lastScrollLine=n}this._preventEditorSDebounced()}},{key:"_preventEditorS",value:function(){this._editor.editor()&&(this._scrollChangeDisposable&&this._scrollChangeDisposable.dispose(),this._scrollChangeDisposable=this._editor.editor().onDidScrollChange(this._syncScrollEditorDebounce))}},{key:"_preventPreviewS",value:function(){this._previewContainer&&y.a.on(this._preview.getScrollContainer(),this._syncScrollPreviewDebounce)}},{key:"_buildScrollMapFromEditor",value:function(e){var t,n,i,o,r,a,s,l,c,d=this._preview.getScrollContainer();for(c=[],i=[],s=[],l=e.getLineCount(),t=1;t<=l+1;t++)s.push(t);for(t=1;t<l+1;t++)c.push(-1);if(x.a.isFunction(d.offset))i.push(0),c[0]=0,n=d.scrollTop()-d.offset().top,d.find(".codio-md-line").each((function(e,t){var o=v()(t),r=o.data("line");""!==r&&(0!==(r=s[r])&&i.push(r),c[r]=Math.round(o.offset().top+n))})),c[l]=d[0].scrollHeight;else{var u=this._getIframeMap(d);if(0===x.a.keys(u).length)return null;n=0,x.a.isUndefined(u[0])&&(i.push(0),c[0]=0),x.a.forEach(u,(function(e,t){t=parseInt(t,10),c[t]=e,i.push(t)})),c[l]=d.scrollHeight}for(i.push(l),o=0,t=1;t<l;t++)-1===c[t]?(r=i[o],a=i[o+1],c[t]=Math.round((c[a]*(t-r)+c[r]*(a-t))/(a-r))):o++;return c}},{key:"_getIframeMap",value:function(e){return e.lineMap}},{key:"setModel",value:function(e){delete this.scrollMap,this._editor.setModel(e),this._preview.setModel(e)}}]),e}();t.default=function(e){return"preview"===e.view?new G(e):"splitview"===e.view?new Y(e):new I(e)}}}]);
//# sourceMappingURL=http://sourcemaps.codio.test:22334/client/js/19.b4aaff75611715868744.js.map