/*! For license information please see 0.c4d7c9ff294e7d084b59.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1172:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var i,r=n(249),o=n.n(r),a=n(41),s=n.n(a),c=n(46),l=n.n(c),u=n(291),d=n.n(u),h=n(277),_=n.n(h),b=n(78),f=n.n(b),v=n(79),g=n.n(v),m=n(53),p=n.n(m),k=n(49),y=n.n(k),C=n(1),N=n.n(C),H=n(0),D=n.n(H),I=n(292),M=n(2),B=n(613),W=n(63);function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return g()(this,n)}}var L="code-commented-highlight",P="comment",T="plus",S=(i={},y()(i,P,"code-comments-gutter-icon-comment"),y()(i,T,"code-comments-gutter-icon-plus"),i),R=function(e){f()(n,e);var t=w(n);function n(e){var i;return s()(this,n),(i=t.call(this,e))._c_activated=!1,i._c_gutterHoveredInfo=null,i._c_debounceFileChange=D.a.debounce(i._c_onFileChange.bind(d()(i)),1e3,{maxWait:5e3}),i._c_debounceUpdateWidgetPositions=D.a.debounce(i._c_updateWidgetPositions.bind(d()(i)),200,{maxWait:1e3}),i}return l()(n,[{key:"_c_setLinesHighlight",value:function(e,t){return this.editor().deltaDecorations([],[{range:W.a.Range.fromPositions({lineNumber:e,column:1},{lineNumber:t,column:1}),options:{isWholeLine:!0,className:L}}])}},{key:"_c_addGutterMarker",value:function(e,t,n){var i={lineNumber:t,column:1};return this.editor().deltaDecorations([],[{range:W.a.Range.fromPositions(i,i),options:{isWholeLine:!0,glyphMarginClassName:"ss-icon ".concat(S[e]," ").concat(n?"collapsed":"")}}])}},{key:"_c_toggleThread",value:function(e){var t=this,n=e.overlayWidget,i=e.thread,r=e.el,o=e.highlightId,a=e.viewZoneId,s=e.gutterMarkerId,c=e.lineHandle,l=i.lineNumber+i.lineCount;if(this.editor().deltaDecorations(s,[]),e.gutterMarkerId=this._c_addGutterMarker(P,l,n),n)this.editor().removeOverlayWidget(n),r&&r.remove(),o&&this.editor().deltaDecorations(o,[]),a&&this.editor().changeViewZones((function(e){e.removeZone(a)})),e.overlayWidget=null,e.viewZoneId=null,e.el=null,e.highlightId=null;else{var u=B.a(i),d=this._c_renderWidget(i.id,c,i.lineCount,u.get(0));e.highlightId=this._c_setLinesHighlight(i.lineNumber+1,l),e.el=u,d.then((function(t){var n=t.viewZoneId,i=t.overlayWidget;e.overlayWidget=i,e.viewZoneId=n}))}D.a.defer((function(){return t._c_updateWidgetPositions()})),B.b(i,!!n)}},{key:"_c_getContext",value:function(e,t){return{code:this.editor().getValueInRange(W.a.Range.fromPositions({lineNumber:e,column:1},{lineNumber:e+t-1,column:Number.MAX_SAFE_INTEGER})),codeContextBefore:this.editor().getValueInRange(W.a.Range.fromPositions({lineNumber:e-5,column:1},{lineNumber:e-1,column:Number.MAX_SAFE_INTEGER})),codeContextAfter:this.editor().getValueInRange(W.a.Range.fromPositions({lineNumber:e+t,column:1},{lineNumber:e+t+5-1,column:Number.MAX_SAFE_INTEGER}))}}},{key:"_c_addThread",value:function(e){this._c_clearCurrentHovered();var t=e,n=1,i=this.editor().getSelections();if(i.length){var r=i&&D.a.find(i,(function(t){return t.startLineNumber<=e&&t.endLineNumber>=e}));r&&(t=r.startLineNumber,n=r.endLineNumber-t+1)}var o=this._c_getContext(t,n),a=B.e(this.fileName,t-1,n,o.code,o.codeContextBefore,o.codeContextAfter);this._c_gutterHoveredInfo=null,this._c_refreshThread(a.id)}},{key:"_c_updateWidgetPositions",value:function(){var e=this;this._c_lineWidgets.forEach((function(t){var n=t.overlayWidget;n&&e.editor().layoutOverlayWidget(n)}))}},{key:"_c_onMouseMove",value:function(e){var t=e.target,n=t.position,i=2===t.type;if(!i&&this._c_clearCurrentHovered(),i&&(!this._c_gutterHoveredInfo||n.lineNumber!==this._c_gutterHoveredInfo.lineNumber)){var r=D.a.find(this._c_lineWidgets,(function(e){var t=e.thread;return n.lineNumber===t.lineNumber+t.lineCount}));this._c_clearCurrentHovered(),r||(this._c_gutterHoveredInfo={lineNumber:n.lineNumber,id:this._c_addGutterMarker(T,n.lineNumber)})}}},{key:"_c_onMouseLeave",value:function(){this._c_clearCurrentHovered()}},{key:"_c_onMouseDown",value:function(e){var t=e.target,n=t.position;if(2===t.type){var i=D.a.find(this._c_lineWidgets,(function(e){var t=e.thread;return t.lineNumber+t.lineCount===n.lineNumber}));i?i.thread.temporary?B.g(i.thread,i.thread.comments[0].id):this._c_toggleThread(i):this._c_addThread(n.lineNumber)}}},{key:"_c_clearCurrentHovered",value:function(){null!==this._c_gutterHoveredInfo&&(this.editor().deltaDecorations(this._c_gutterHoveredInfo.id,[]),this._c_gutterHoveredInfo=null)}},{key:"activate",value:function(e){var t=this;return this._c_editorClosed?N.a.Deferred().reject():_()(p()(n.prototype),"activate",this).apply(this,arguments).then((function(){if(t.fileName&&!t._c_activated){t._c_eventHandles=[],t._c_lineWidgets=[],t._c_gutterHoveredInfo=null,e.setOption("glyphMargin",!0);var n=D.a.bind(t._c_eventHandles.push,t._c_eventHandles);if(n(M.a.subscribe("project:commentsUpdated",(function(e,n){var i=n.updateId;D.a.defer((function(){return t._c_calculateChangedThreads(i)}))}))),n(M.a.subscribe("codeComments:comment:removed:#path:#threadId",(function(e){var n=e.path,i=e.threadId;return t.fileName===n&&t._c_refreshThread(i)}))),n(M.a.subscribe("codeComments:thread:removed:#path:#id",(function(e){var n=e.path,i=e.id;return t.fileName===n&&t._c_destroyThread(i)}))),n(M.a.subscribe("codeComments:comment:cancelled:#path:#threadId",(function(e){var n=e.path,i=e.threadId;return t.fileName===n&&t._c_refreshThread(i)}))),n(M.a.subscribe("codeComments:comment:saved:#path:#threadId",(function(e,n){var i=e.path,r=e.threadId;t.fileName===i&&(n&&t._c_destroyThread(n),t._c_refreshThread(r))}))),n(M.a.subscribe("codeComments:comment:edit:#path:#threadId",(function(e){var n=e.path,i=e.threadId;return t.fileName===n&&t._c_refreshThread(i)}))),n(M.a.subscribe("codeComments:comment:add:#path:#threadId",(function(e){var n=e.path,i=e.threadId;return t.fileName===n&&t._c_refreshThread(i)}))),n(M.a.subscribe("panel:size:change",t._c_updateSize.bind(t))),!t._c_onLocalFileChange){var i=t.fileName;t._c_onLocalFileChange=function(){i===t.fileName?t._c_debounceFileChange&&t._c_debounceFileChange():i=t.fileName}}t._c_onContentChangeDisposableHandler=t.editor().onDidChangeModelContent(t._c_onLocalFileChange.bind(t)),t._c_onContentChangeDisposableHandler=t.editor().onDidChangeModelContent((function(){t._c_onLocalFileChange(),t._c_debounceUpdateWidgetPositions()})),t._c_activateComments()}}))}},{key:"_c_loadComments",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return B.d(this.fileName,e).then((function(e){return e.commentThreadsMap}))}},{key:"_c_activateComments",value:function(){var e=this;this._c_activated=!0,this._c_loadComments().then((function(t){e._c_onMouseMoveDisposableHandler||e.editor()&&(e._c_onMouseMoveDisposableHandler=e.editor().onMouseMove(e._c_onMouseMove.bind(e)),e._c_onMouseLeaveDisposableHandler=e.editor().onMouseLeave(e._c_onMouseLeave.bind(e)),e._c_onMouseDownDisposableHandler=e.editor().onMouseDown(e._c_onMouseDown.bind(e)),D.a.defer((function(){e.editor()&&D.a.each(t,(function(t){return e._c_renderThread(t)}))})))}))}},{key:"_c_onFileChange",value:function(){var e=this,t=[],n=[];this._c_lineWidgets.forEach((function(i){var r=i.thread,o=i.lineHandle.getLineNumber(),a=e._c_getContext(o,r.lineCount);null===o||a.code!==r.context.code?t.push(r.id):a.codeContextBefore===r.context.codeContextBefore&&a.codeContextAfter===r.context.codeContextAfter&&o===r.lineNumber+1||n.push({lineNumber:o-1,context:a,thread:r})})),B.i(this.fileName,t,n)}},{key:"_c_updateSize",value:function(){var e=this;this.editor().changeViewZones((function(t){D.a.each(e._c_lineWidgets,(function(e){var n=e.viewZoneId;return n&&t.layoutZone(n)}))}))}},{key:"_c_refreshThread",value:function(e){var t=this;if(this.editor()){var n=this.editor().getScrollLeft(),i=this.editor().getScrollTop();return this._c_loadComments().then((function(n){var i=D.a.find(n,(function(t){return t.id===e}));return t._c_destroyThread(e),t._c_renderThread(i)})).then((function(){t.editor().setScrollPosition(i,n),D.a.defer((function(){return t._c_updateWidgetPositions()}))}))}}},{key:"_c_collectEditState",value:function(){return D.a.map(N()(".comment.editMode"),(function(e){var t=N()(e);return{id:t.data("id"),comment:t.find(".message-ta").val(),newItem:!!t.data("new"),threadId:t.closest(".comments-list").data("thread-id")}}))}},{key:"_c_refreshThreads",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this.editor()){var n=this._c_collectEditState(),i=D.a.keyBy(n,"id"),r=D.a.filter(n,(function(e){return e.newItem})),o=this.editor().getScrollLeft(),a=this.editor().getScrollTop();this._c_loadComments(t).then((function(s){e._c_clearAllThreads(t),D.a.each(s,(function(o){if(t){n.length&&(o.comments=D.a.map(o.comments,(function(e){var t=i[e.id];return t&&(e.editMode=!0,e.comment=t.comment),e})));var a=D.a.filter(r,(function(e){return e.threadId===o.id}));a.length&&D.a.each(a,(function(e){var t=B.h();t.comment=e.comment,t.id=e.id,o.comments.push(t)}))}e._c_renderThread(o)})),e.editor().setScrollPosition(a,o),D.a.defer((function(){return e._c_updateWidgetPositions()}))}))}}},{key:"_c_renderWidget",value:function(e,t,n,i){var r=N.a.Deferred();i.style.left=this.editor().getLayoutInfo().contentLeft+"px";var o={getId:function(){return e},getDomNode:function(){return i},getPosition:function(){return null}};return this.editor().addOverlayWidget(o),this.editor().changeViewZones((function(e){var a=document.createElement("div");a.classList.add(L);var s=e.addZone({afterLineNumber:t.getLineNumber()+n-1,get heightInPx(){var e=getComputedStyle(i),t=parseInt(e.marginTop),n=parseInt(e.marginBottom);return i.offsetHeight+t+n},domNode:a,onDomNodeTop:function(e){i.style.top=e+"px"}});r.resolve({viewZoneId:s,overlayWidget:o})})),r.promise()}},{key:"_c_renderThread",value:function(e){var t=this,n=e.collapsed,i=e.lineNumber+e.lineCount,r=null,o=null,a=this.editor().getLineHandle(e.lineNumber+1),s=N.a.Deferred().resolve({});n||(r=B.a(e),s=this._c_renderWidget(e.id,a,e.lineCount,r.get(0)),o=this._c_setLinesHighlight(e.lineNumber+1,i));var c=this._c_addGutterMarker(P,i,n);return s.then((function(n){var i=n.viewZoneId,s=n.overlayWidget;t._c_lineWidgets.push({thread:e,highlightId:o,viewZoneId:i,gutterMarkerId:c,overlayWidget:s,el:r,lineHandle:a})}))}},{key:"_c_clearAllThreads",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._c_lineWidgets=D.a.filter(this._c_lineWidgets,(function(n){var i=n.highlightId,r=n.viewZoneId,a=n.gutterMarkerId,s=n.overlayWidget,c=n.el;return!(!t||!N()(c).data("temporary"))||(s&&e.editor().removeOverlayWidget(s),c&&c.remove(),i=i||[],e.editor().deltaDecorations([].concat(o()(i),o()(a)),[]),r&&e.editor().changeViewZones((function(e){e.removeZone(r)})),!1)}))}},{key:"_c_destroyThread",value:function(e){var t=D.a.findIndex(this._c_lineWidgets,(function(t){return t.thread.id===e})),n=this._c_lineWidgets[t];if(!n)return null;var i=n.highlightId,r=n.viewZoneId,a=n.gutterMarkerId,s=n.overlayWidget,c=n.el;s&&this.editor().removeOverlayWidget(s),c&&c.remove();var l=i||[];return this.editor().deltaDecorations([].concat(o()(l),o()(a)),[]),r&&this.editor().changeViewZones((function(e){e.removeZone(r)})),this._c_lineWidgets.splice(t,1),n}},{key:"_c_calculateChangedThreads",value:function(e){this._c_refreshThreads(e)}},{key:"_c_clean",value:function(){this.editor()&&this.editor().setOption("glyphMargin",!1),this._c_debounceFileChange&&this._c_debounceFileChange.flush(),this._c_activated=!1,this._c_gutterHoveredInfo=null,this._c_onMouseMoveDisposableHandler&&this._c_onMouseMoveDisposableHandler.dispose(),this._c_onMouseMoveDisposableHandler=null,this._c_onMouseLeaveDisposableHandler&&this._c_onMouseLeaveDisposableHandler.dispose(),this._c_onMouseLeaveDisposableHandler=null,this._c_onMouseDownDisposableHandler&&this._c_onMouseDownDisposableHandler.dispose(),this._c_onMouseDownDisposableHandler=null,this._c_onContentChangeDisposableHandler&&this._c_onContentChangeDisposableHandler.dispose(),this._c_onContentChangeDisposableHandler=null,this._c_onLocalFileChange=null,this._c_eventHandles&&(this._c_eventHandles.forEach((function(e){return M.a.unsubscribe(e)})),this._c_eventHandles.length=0),this.editor()&&(this._c_clearAllThreads(),B.c(this.fileName))}},{key:"deactivate",value:function(){return this._c_clean(),_()(p()(n.prototype),"deactivate",this).apply(this,arguments)}},{key:"close",value:function(){return this._c_clean(),this._c_debounceFileChange=null,this._c_debounceUpdateWidgetPositions=null,this._c_editorClosed=!0,_()(p()(n.prototype),"close",this).apply(this,arguments)}}]),n}(I.a),x=function(){return R}},1173:function(e,t,n){"use strict";var i=n(41),r=n.n(i),o=n(46),a=n.n(o),s=n(277),c=n.n(s),l=n(78),u=n.n(l),d=n(79),h=n.n(d),_=n(53),b=n.n(_),f=n(1),v=n.n(f),g=n(0),m=n.n(g),p=n(2),k=n(63),y=n(234),C=n(1172),N=n(1177);function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=b()(e);if(t){var r=b()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h()(this,n)}}var D=p.a.create(N),I=Object(C.a)(),M="debugger-line",B=0,W=1,w=2,L=function(e){u()(n,e);var t=H(n);function n(e){var i;return r()(this,n),(i=t.call(this,e))._b_breakpointsActivated=!1,i._b_activeBP=[],i._b_currentBreakpointLine=null,i}return a()(n,[{key:"_b_onMouseDownBreakpoints",value:function(e){var t=e.target,n=t.position;if(4===t.type){var i=this._b_activeBP.some((function(e){return e.lineNumber===n.lineNumber}))?B:W;this._b_setBreakpointMarker(n.lineNumber,i),this._b_breakpointHandler([{state:i,line:n.lineNumber-1}])}}},{key:"_b_checkBP",value:function(e){var t=this,n=[],i=[];m.a.each(this._b_activeBP,(function(e){var t,r=e.lineHandle.getLineNumber();r!==e.lineNumber&&(t={state:null!==r?W:B,line:e.lineNumber-1,newLine:r-1},null!=r?e.line=r:(t={state:B,line:e.lineNumber-1},n.push(e.lineNumber)),t&&i.push(t))})),m.a.each(n,(function(e){return t._b_setBreakpointMarker(e,B,!0)})),0!==i.length&&this._b_breakpointHandler(i,e)}},{key:"_b_addGutterBreakpointMarker",value:function(e,t){var n={lineNumber:e,column:1};return this.editor().deltaDecorations([],[{range:k.a.Range.fromPositions(n,n),options:{isWholeLine:!0,linesDecorationsClassName:"".concat("code-breakpoint-gutter-icon"," ").concat(t===w?"inactive":"")}}])}},{key:"_b_setBreakpointMarker",value:function(e,t){if(this.editor()){var n=m.a.findIndex(this._b_activeBP,(function(t){return t.lineNumber===e})),i=this._b_activeBP[n];if(i&&(this.editor().deltaDecorations(i.markerId,[]),this._b_activeBP.splice(n,1)),t!==B){var r=this._b_addGutterBreakpointMarker(e,t),o=this.editor().getLineHandle(e);this._b_activeBP.push({lineNumber:e,lineHandle:o,markerId:r})}}}},{key:"_b_breakpointState",value:function(e){var t;t=e.state?e.active?W:w:B,this._b_setBreakpointMarker(e.line+1,t)}},{key:"_highlightCode",value:function(){this._editor&&(this._highlight&&!0===this._highlight.debuggerLine?this._b_breakpointHit(this._highlight.ref):c()(b()(n.prototype),"_highlightCode",this).call(this))}},{key:"_b_breakpointHit",value:function(e){if(m.a.isNumber(this._b_currentBreakpointLine)){var t=this._b_currentBreakpointLine+1,n=this.editor().getLineDecorations(t),i={lineNumber:t,column:1},r=k.a.Range.fromPositions(i,i),o=n.filter((function(e){return e.range.equalsRange(r)&&e.options.className===M})).map((function(e){return e.id}));o.length&&this.editor().deltaDecorations(o,[])}if(m.a.isNumber(e)){var a=e+1,s={lineNumber:a,column:1},c=k.a.Range.fromPositions(s,s);this.editor().scrollToLine(a),this.editor().deltaDecorations([],[{range:c,options:{isWholeLine:!0,className:M}}])}this._highlight=null===e?null:{ref:e,debuggerLine:!0},this._b_currentBreakpointLine=e}},{key:"_b_breakpointHandler",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];D.breakpoint({path:this.fileName},{items:e,force:t})}},{key:"activate",value:function(e){var t=this;return c()(b()(n.prototype),"activate",this).apply(this,arguments).then((function(){if(!t._b_breakpointsActivated)return t._b_breakpointsActivated=!0,e.setOption("lineDecorationsWidth",26),t._bindEvents(),y.a.breakpoints().then((function(e){var n=m.a.filter(e,(function(e){return t.fileName===e.path}));m.a.defer((function(){m.a.each(n,(function(e){t._b_setBreakpointMarker(e.line+1,e.active?W:w)}))}))}))}))}},{key:"_bindEvents",value:function(){var e=this,t=function(t){return"command:debug:"+t+":"+e.fileName};this._b_handlerBreakpointHit=p.a.subscribe(t("breakpoint-hit"),(function(t,n){e._b_breakpointHit(n)})),this._b_handlerBreakpointClear=p.a.subscribe(t("breakpoint-clear"),(function(){e._b_breakpointHit(null)})),this._b_handlerBreakpointState=p.a.subscribe(t("breakpoint-state"),(function(t,n){e._b_breakpointState(n)})),this._b_checkBPDebounce=m.a.debounce(this._b_checkBP.bind(this,!1),5e3,{maxWait:1e4}),this._b_mouseDownDisposableHandler=this.editor().onMouseDown(this._b_onMouseDownBreakpoints.bind(this)),this._b_changeDisposableHandler=this.editor().onDidChangeModelContent(this._b_checkBPDebounce),this._b_handlerDebuggerSwitched=p.a.subscribe("debug:panel_switched",this._b_updateEditor.bind(this)),this._b_debuggerStartHandler=p.a.subscribe("command:debug:start",this._b_forceCheckBP.bind(this)),this._b_debuggerRestartHandler=p.a.subscribe("command:debug:restart",this._b_forceCheckBP.bind(this)),v()(window).on("beforeunload",(function(){e._b_forceCheckBP.bind(e)}))}},{key:"_b_forceCheckBP",value:function(){this._b_checkBP&&this._b_checkBP(!0)}},{key:"_b_updateEditor",value:function(){this.editor()&&this.editor().layout()}},{key:"_b_cleanup",value:function(){this._b_checkBPDebounce&&this._b_checkBPDebounce.flush(),this._b_checkBPDebounce=null,this._b_breakpointsActivated=!1,this.editor()&&this.editor().setOption("lineDecorationsWidth",10),this._b_handlerBreakpointHit&&p.a.unsubscribe(this._b_handlerBreakpointHit),this._b_handlerBreakpointHit=null,this._b_handlerBreakpointClear&&p.a.unsubscribe(this._b_handlerBreakpointClear),this._b_handlerBreakpointClear=null,this._b_handlerBreakpointState&&p.a.unsubscribe(this._b_handlerBreakpointState),this._b_handlerBreakpointState=null,this._b_handlerDebuggerSwitched&&p.a.unsubscribe(this._b_handlerDebuggerSwitched),this._b_handlerDebuggerSwitched=null,this._b_mouseDownDisposableHandler&&this._b_mouseDownDisposableHandler.dispose(),this._b_mouseDownDisposableHandler=null,this._b_changeDisposableHandler&&this._b_changeDisposableHandler.dispose(),this._b_changeDisposableHandler=null,this._b_debuggerStartHandler&&p.a.unsubscribe(this._b_debuggerStartHandler),this._b_debuggerStartHandler=null,this._b_debuggerRestartHandler&&p.a.unsubscribe(this._b_debuggerRestartHandler),this._b_debuggerRestartHandler=null,this._b_activeBP=[]}},{key:"deactivate",value:function(){return this._b_cleanup(),c()(b()(n.prototype),"deactivate",this).apply(this,arguments)}},{key:"close",value:function(){return this._b_cleanup(),c()(b()(n.prototype),"close",this).apply(this,arguments)}}]),n}(I);t.a=L},1177:function(e){e.exports=JSON.parse('{"breakpoint":"file:editor:breakpoint:#path"}')}}]);
//# sourceMappingURL=http://sourcemaps.codio.test:22334/client/js/0.c4d7c9ff294e7d084b59.js.map